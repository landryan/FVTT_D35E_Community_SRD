{
	"_id": "u8FvYnNHhJNPRJAn",
	"_key": "!macros!u8FvYnNHhJNPRJAn",
	"author": "Wh2LMImbzawNAQ7v",
	"command": "async function DoSort(character, equipment) {\n  equipment.sort((a, b) => {\n    return a.name > b.name ? 1 : -1;\n  });\n\n  let count = 1000;\n  for (let itemofequipment of equipment) {\n    console.log(\"Updating item:\",itemofequipment.name,\" to sort\", count);\n    let data = [{ _id: itemofequipment._id, sort: count }];\n    await character.updateEmbeddedDocuments(\"Item\", data, {});\n    count += 100;\n  }\n\n}\n\nasync function EquipmentSort() {\n  // Get the selected actor\n  let actor = canvas.tokens.controlled[0].actor;\n\n  let id = actor.id;\n  let character = game.actors.get(id);\n  console.log(\"Name:\",character.name);\n\n// Get equipment and weapon items, and convert them to arrays\nlet equipmentItems = character.items.search({\n  query: \"\",\n  filters: [{ field: \"type\", value: \"equipment\" }],\n});\n\nawait DoSort(character, equipmentItems)\n\n// Get weapon items\nlet weaponItems = character.items.search({\n  query: \"\",\n  filters: [{ field: \"type\", value: \"weapon\" }],\n});\n\nawait DoSort(character, weaponItems)\n\n// Get loot items\nlet lootItems = character.items.search({\n  query: \"\",\n  filters: [{ field: \"type\", value: \"loot\" }],\n});\n\nawait DoSort(character, lootItems)\n\n// Get consumable items\nlet consumableItems = character.items.search({\n  query: \"\",\n  filters: [{ field: \"type\", value: \"consumable\" }],\n});\n\nawait DoSort(character, consumableItems)\n\n// ######################## //\n\n  new Dialog({\n    title: \"Alert: Equipment Sorting\",\n    content: '<h1 style=\"text-align:center\">Done!</h1>',\n    buttons: { close: { label: \"Close\" } },\n  }).render(true);\n}\n\n// Check if a token is selected\nif (canvas.tokens.controlled.length === 0) {\n  ui.notifications.warn(\"Please select a token.\");\n  return;\n} else {\n  new Dialog({\n    title: \"Alert: Equipment Sorting\",\n    content:\n      '<h2 style=\"text-align:center\">Depending on how many items you have, this will take a while.</h2>',\n    buttons: { close: { label: \"Close\" } },\n  }).render(true);\n\n  EquipmentSort();\n}",
	"folder": null,
	"img": "https://abrpgfoundrybucket.s3.eu-west-2.amazonaws.com/Generic%20Assets/icons/chests/backpack.png",
	"name": "Sort Items",
	"scope": "global",
	"type": "script"
}
